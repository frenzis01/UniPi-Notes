\chapter{Caracterización de ataques a ICS con Mitre}
\label{chap:01}
\section{Introducción}

La tarea nos pide de leer un artículo de revisión de 15 ataques a sistemas de control industrial (ICS) y elegir 5 de ellos para caracterizarlos con la matriz de \href{attack.mitre.org/matrices/ics/}{Mitre ATT\&CK}. La matriz de Mitre ATT\&CK es una base de datos de tácticas, técnicas y procedimientos (TTP) utilizados por los atacantes en el ciberespacio. Esta matriz se utiliza para comprender mejor las amenazas y mejorar la defensa cibernética.

\framedt{Tarea a realizar}{
\begin{itemize}
	\item Lee detenidamente el documento para reforzar los conceptos expuestos en clase sobre seguridad en ICS e infraestructuras críticas.
	\item Elige los 5 ataques que consideres más significativos o que pienses que están mejor descritos.
	\item Para cada uno de esos ataques,  en base a la información del documento, y al contenido de la matriz de MITRE para ICS,  indica que tácticas y técnicas  utilizaron los atacantes. Explica porqué piensas que en cada caso utilizaron esas tácticas y técnicas. Indica también el tipo de respuesta descrito para cada ataque y si te parece adecuado, o bien propondrías otro tipo posible de respuesta.
\end{itemize}
}

\subsection{WWS and ICSs}

El artículo empieza con una introducción sobre el WWS (Water and Wastewater Sector), que es un sector crítico para la sociedad, ya que proporciona agua potable y trata las aguas residuales. 
Este es, según el U.S. Department of Homeland Security, uno de los sectores más targetados por los ciberataques. Su salvaguardia frente a las amenazas de ciberseguridad se considera una cuestión de prioridad nacional.

WWS son sistemas de control industrial (ICS) que se utilizan para supervisar y controlar las infraestructuras de agua y aguas residuales. Estos sistemas son esenciales para garantizar la calidad del agua, la eficiencia operativa y la seguridad pública.

La major parte de los ICS en el sector WWS son sistemas SCADA (Supervisory Control and Data Acquisition), que permiten la supervisión y control remoto de los procesos industriales. Estos sistemas se componen de sensores, controladores lógicos programables (PLC) y estaciones de trabajo que se comunican entre sí para supervisar y controlar los procesos.

Hay una MTU (Master Terminal Unit) que se encarga de la supervisión y control de los procesos, y una RTU (Remote Terminal Unit) que se encarga de la supervisión y control de los dispositivos remotos. La MTU se comunica con la RTU a través de una red de comunicación, que puede ser una red privada o una red pública.
La HMI (Human-Machine Interface) es la interfaz que permite a los operadores interactuar con el sistema SCADA. La HMI se utiliza para supervisar y controlar los procesos, y para visualizar la información del sistema.

Durante muchos años, los sistemas SCADA y, en general, las redes OT en entornos industriales, estaban
no estaban conectadas a las redes informáticas corporativas ni a Internet. Sin embargo, a medida que la tecnología avanzaba, muchas organizaciones planearon consolidar las redes IT y OT superpuestas.

\subsection{Redes ICS}

La nueva generación de redes IT-OT convergentes en los sistemas de control industrial, también conocida como Industrial Internet of Things (IIoT), ya no está air-gapped.\\
Una red ICS està dividida por niveles y zonas:
\begin{itemize}
   \item \textbf{Enterprise zone }- that includes assets for business logistics and enterprise systems, representing Level 4 and 5, respectively. This zone is also known as IT network.
   \item \textbf{Demilitarized zone (DMZ) }- that separates IT and OT networks, thus preventing direct access to OT devices from the IT network. All corporate-accessible services (e.g., web, 120 email) reside in this zone
   \item \textbf{Manufacturing and Control zone }- The former refers to the entire OT domain, including Levels 0, 1, 2, and 3; the latter refers to Levels 0, 1, and 2, so it is equivalent to the traditional ICS architecture shown in Figure 1a. Level 3 provides site-level operation and asset management. Plant historian, production scheduling and reporting, patch and file services reside at Level 3
\end{itemize}

\subsection{Ataques a ICS}
Los ataques a sistemas de control industrial (ICS) son cada vez más frecuentes y sofisticados. En este trabajo, analizaremos cinco ataques significativos a sistemas de agua y aguas residuales (WWS), utilizando la matriz de MITRE ATT\&CK para ICS. Esta matriz nos permite categorizar las tácticas, técnicas y procedimientos utilizados por los atacantes en entornos ICS.

\section{Ataque 1: Maroochy Water Services, Australia, 2000}

\subsection{Descripción del incidente}
En el año 2000, un ex empleado atacó el sistema SCADA de Maroochy Shire en Queensland, Australia. El atacante era un antiguo supervisor de sitio para Hunter Watertech Pty Ltd (HWT), un contratista externo que había instalado RTUs en 142 estaciones de bombeo. Después de renunciar en diciembre de 1999, realizó múltiples intrusiones al sistema SCADA entre enero y abril del 2000, causando malfuncionamientos como pérdida de comunicaciones, falsas alarmas y alteración de configuraciones. El resultado fue la liberación de aproximadamente un millón de litros de aguas residuales sin tratar al medio ambiente.

\subsection{Tácticas y técnicas según MITRE ATT\&CK}
Según la matriz MITRE ATT\&CK para ICS, el ataque utilizó las siguientes tácticas y técnicas:

\begin{itemize}
    \item \textbf{Acceso Inicial} - El atacante utilizó la técnica de \textit{Aprovechamiento de credenciales válidas} (T0859), ya que mantuvo acceso a sus credenciales después de dejar la empresa.
    
    \item \textbf{Ejecución} - Empleó la técnica de \textit{Comandos y control de ingeniería} (T0871), utilizando su conocimiento para enviar comandos legítimos con intenciones maliciosas.
    
    \item \textbf{Impacto} - Utilizó la técnica de \textit{Manipulación de parámetros de control} (T0836), alterando la configuración de las estaciones de bombeo para causar el vertido de aguas residuales.
\end{itemize}

\subsection{Justificación de las tácticas y técnicas}
El atacante eligió estas tácticas y técnicas por varias razones:

\begin{itemize}
    \item Como ex supervisor del proyecto, tenía un conocimiento íntimo del sistema y sus vulnerabilidades, lo que le permitió aprovechar credenciales válidas para acceder al sistema.
    
    \item La falta de procedimientos para revocar accesos de exempleados facilitó su intrusión y persistencia en el sistema durante meses.
    
    \item Su conocimiento técnico le permitió emitir comandos de ingeniería que parecían legítimos pero causaban daños significativos.
    
    \item La manipulación de parámetros de control fue una táctica efectiva dada la ausencia de monitoreo de comportamientos anómalos en el sistema.
\end{itemize}

\subsection{Respuesta al incidente}
La respuesta consistió en una investigación que culminó con la captura del sospechoso en abril de 2000. Se le encontró en posesión de equipos de control industrial, como un ordenador Compact 500, un radio bidireccional, un portátil, un transformador y cables. Posteriormente fue sentenciado a dos años de prisión y ordenado a pagar 13,111 dólares australianos por los daños causados. La limpieza del vertido requirió días y recursos sustanciales.

\subsection{Evaluación de la respuesta}
La respuesta fue principalmente reactiva y no preventiva. Considero que fue inadecuada por varias razones:

\begin{itemize}
    \item No existían procedimientos de ciberseguridad que pudieran prevenir el ataque.
    \item No había un sistema para revocar accesos cuando un empleado dejaba la empresa.
    \item Tardaron meses en identificar que las fallas eran causadas por intervención humana.
\end{itemize}

Una respuesta más adecuada habría incluido la implementación de controles de seguridad básicos según el protocolo NIST SP 800-53, como la terminación inmediata de accesos de exempleados, autenticación multifactor, segregación de redes y monitoreo continuo de actividades sospechosas en el sistema SCADA.

\section{Ataque 2: Kemuri Water Company (seudónimo), EE.UU., 2016}

\subsection{Descripción del incidente}
En 2016, una empresa de servicios de agua en EE.UU. (bajo el seudónimo Kemuri Water Company) contrató a Verizon Security Solutions para realizar una evaluación de ciberseguridad de sus sistemas. La evaluación reveló vulnerabilidades de alto riesgo, incluyendo el uso de sistemas obsoletos como un ordenador AS400 que servía para funciones críticas de IT y OT, con conexiones directas a múltiples redes. El análisis forense descubrió que hacktivistas patrocinados por un estado habían explotado la aplicación de pago en internet para acceder al sistema AS400, resultando en la exfiltración de 2.5 millones de registros únicos y manipulación de productos químicos y tasas de flujo.

\subsection{Tácticas y técnicas según MITRE ATT\&CK}
Según la matriz MITRE, este ataque empleó:

\begin{itemize}
    \item \textbf{Acceso Inicial} - \textit{Explotación de aplicaciones públicas} (T0819), aprovechando vulnerabilidades en la aplicación de pago por internet.
    
    \item \textbf{Movimiento Lateral} - \textit{Explotación de rutas de confianza} (T0884), utilizando la conexión entre la aplicación de pago y el sistema AS400.
    
    \item \textbf{Recolección} - \textit{Puntos de datos de sistemas de control automatizado} (T0802), obteniendo información sobre el sistema de control industrial.
    
    \item \textbf{Impacto} - \textit{Manipulación de ajustes} (T0836), alterando productos químicos y tasas de flujo.
\end{itemize}

\subsection{Justificación de las tácticas y técnicas}
Los atacantes eligieron estas tácticas porque:

\begin{itemize}
    \item La aplicación de pago por internet presentaba una puerta de entrada fácil al no estar adecuadamente protegida.
    
    \item La conexión directa entre el sistema IT (aplicación de pago) y OT (AS400) representaba una ruta de confianza que eliminaba la necesidad de superar barreras adicionales de seguridad.
    
    \item El sistema AS400 obsoleto carecía de parches de seguridad y controles modernos, facilitando la recolección de datos y manipulación de parámetros.
    
    \item La autenticación de factor único simplificó el acceso no autorizado a sistemas críticos.
\end{itemize}

\subsection{Respuesta al incidente}
La respuesta incluyó la terminación inmediata del acceso hacia y desde el sistema de gestión de cuentas web y el bloqueo de la conectividad saliente del sistema AS400. Se recomendó reemplazar los sistemas antiguos con versiones más modernas.

\subsection{Evaluación de la respuesta}
La respuesta fue adecuada en el corto plazo pero insuficiente para prevenir futuros incidentes. Mi evaluación es:

\begin{itemize}
    \item Positivo: La acción inmediata de bloqueo de accesos detuvo el ataque en curso.
    \item Insuficiente: Solo se recomendó, pero no se implementó inmediatamente, el reemplazo de sistemas obsoletos.
\end{itemize}

Propondría además:

\begin{itemize}
    \item Implementación de arquitectura de segmentación de red con zonas desmilitarizadas (DMZ) entre IT y OT.
    \item Autenticación multifactor para todos los sistemas críticos.
    \item Monitoreo continuo de tráfico de red entre zonas IT y OT.
    \item Evaluaciones periódicas de vulnerabilidades y pruebas de penetración.
\end{itemize}

\section{Ataque 3: Empresa de agua europea, 2018}

\subsection{Descripción del incidente}
En enero de 2018, una empresa europea de servicios de agua con un sistema de análisis OT basado en la nube contrató a Radiflow para monitorear su red. El 21 de enero, se detectó tráfico de red sospechoso en la red SCADA, con nuevos enlaces a direcciones IP externas que generaban un cambio importante en la topología de la red. La investigación reveló que las direcciones pertenecían a un "MinerCircle Monero Pool", lo que llevó a la detección de malware de criptominería en la red OT. Aproximadamente el 40\% del tráfico estaba relacionado con operaciones de minería, causando un aumento del 60\% en el consumo total de ancho de banda. Este incidente se considera el primer caso conocido de "cryptojacking" contra un sistema ICS.

\subsection{Tácticas y técnicas según MITRE ATT\&CK}
Las tácticas y técnicas utilizadas incluyen:

\begin{itemize}
    \item \textbf{Acceso Inicial} - Aunque no se especifica en el documento, probablemente utilizaron \textit{Explotación de vulnerabilidades de acceso público} (T0819).
    
    \item \textbf{Ejecución} - \textit{Secuencias de comandos} (T0853), ejecutando scripts maliciosos para la minería de criptomonedas.
    
    \item \textbf{Impacto} - \textit{Agotamiento de recursos} (T0826), utilizando recursos computacionales del sistema para minar criptomonedas.
\end{itemize}

\subsection{Justificación de las tácticas y técnicas}
Los atacantes eligieron estas tácticas por:

\begin{itemize}
    \item Los sistemas OT basados en la nube ofrecen superficies de ataque que pueden no estar adecuadamente protegidas, permitiendo el acceso inicial.
    
    \item El malware de criptominería es relativamente fácil de implementar y puede pasar desapercibido durante períodos prolongados si no se monitorea adecuadamente el rendimiento del sistema.
    
    \item A diferencia de ataques que buscan interrumpir servicios o robar datos, el cryptojacking busca mantenerse operativo el mayor tiempo posible para maximizar ganancias.
    
    \item Los sistemas ICS suelen tener capacidad computacional constante y conexión permanente a internet, lo que los convierte en objetivos atractivos para la minería de criptomonedas.
\end{itemize}

\subsection{Respuesta al incidente}
La empresa de seguridad informó a la empresa de agua sobre el malware de criptominería y los servidores infectados. La recuperación incluyó la actualización del software antivirus en algunos servidores y el refuerzo de la seguridad del firewall. El software antivirus actualizado tuvo éxito en detectar el malware CoinMiner.

\subsection{Evaluación de la respuesta}
La respuesta fue adecuada pero reactiva:

\begin{itemize}
    \item Positivo: La detección temprana del tráfico sospechoso permitió mitigar el impacto.
    \item Positivo: La actualización de antivirus y refuerzo de firewalls fueron medidas apropiadas.
\end{itemize}

Propondría adicionalmente:

\begin{itemize}
    \item Implementación de sistemas de monitoreo de rendimiento para detectar anormalidades en el uso de recursos.
    \item Segmentación de red más estricta entre sistemas OT y conexiones externas.
    \item Auditorías regulares de tráfico de red para identificar comunicaciones sospechosas.
    \item Implementación de listas blancas de aplicaciones para prevenir la ejecución de software no autorizado.
\end{itemize}

\section{Ataque 4: Onslow Water and Sewer Authority, EE.UU., 2018}

\subsection{Descripción del incidente}
En octubre de 2018, Onslow Water and Sewer Authority, una empresa de servicios de agua en Jacksonville (Carolina del Norte), fue atacada por ciberdelincuentes justo después del Huracán Florence. El ataque comenzó con ataques persistentes a través de un virus conocido como EMOTET. Mientras se investigaba, aproximadamente a las 3 am de un sábado, el malware lanzó un virus más sofisticado llamado RYUK, que encriptó archivos y datos. El equipo de IT desconectó inmediatamente las instalaciones de internet, pero no pudieron evitar el cifrado. Los atacantes enviaron un correo electrónico exigiendo un pago para descifrar los archivos dañados, pero la autoridad rechazó negociar.

\subsection{Tácticas y técnicas según MITRE ATT\&CK}
El ataque utilizó las siguientes tácticas y técnicas:

\begin{itemize}
    \item \textbf{Acceso Inicial} - \textit{Phishing dirigido} (T0865), probablemente utilizando EMOTET para el acceso inicial.
    
    \item \textbf{Persistencia} - \textit{Adición de programas de inicio automático} (T0873), asegurando que EMOTET permaneciera activo en el sistema.
    
    \item \textbf{Ejecución} - \textit{Software de usuario} (T0863), desplegando el ransomware RYUK en un momento estratégico.
    
    \item \textbf{Impacto} - \textit{Manipulación de datos} (T0831), cifrando datos críticos para exigir rescate.
\end{itemize}

\subsection{Justificación de las tácticas y técnicas}
Los atacantes eligieron estas tácticas porque:

\begin{itemize}
    \item El momento después de un desastre natural (Huracán Florence) representaba un período de vulnerabilidad aumentada, con personal posiblemente distraído por tareas de recuperación.
    
    \item El lanzamiento del ransomware RYUK a las 3 am de un sábado fue estratégico para minimizar la posibilidad de respuesta inmediata.
    
    \item La combinación de EMOTET (para acceso inicial) y RYUK (para el cifrado) representa un ataque en dos etapas que dificulta la detección y respuesta.
    
    \item El objetivo era claramente financiero, utilizando el cifrado de datos críticos como mecanismo de presión para el pago del rescate.
\end{itemize}

\subsection{Respuesta al incidente}
La autoridad trabajó con el FBI, el DHS, el estado de Carolina del Norte y múltiples empresas de seguridad para remediar y recuperarse. Planificaron reconstruir sus sistemas de IT desde cero y se negaron a pagar el rescate exigido.

\subsection{Evaluación de la respuesta}
La respuesta fue apropiada desde una perspectiva estratégica:

\begin{itemize}
    \item Positivo: La decisión de no pagar el rescate está alineada con las directrices federales y evita incentivar futuros ataques.
    \item Positivo: La colaboración con múltiples agencias de seguridad facilita una respuesta coordinada y apoyo especializado.
    \item Positivo: La reconstrucción completa del sistema elimina posibles puertas traseras dejadas por los atacantes.
\end{itemize}

Como mejora, propondría:

\begin{itemize}
    \item Implementación de respaldo seguro fuera de línea (air-gapped) para datos críticos.
    \item Segmentación de red más estricta para contener posibles infecciones.
    \item Plan de continuidad de operaciones que permita funcionar durante un ataque de ransomware.
    \item Capacitación específica sobre amenazas de phishing, especialmente durante situaciones de crisis como desastres naturales.
\end{itemize}

\section{Ataque 5: Bowman Avenue Dam, EE.UU., 2013}

\subsection{Descripción del incidente}
Entre el 28 de agosto y el 18 de septiembre de 2013, hackers obtuvieron "acceso remoto no autorizado" al sistema SCADA de la presa Bowman Avenue en Rye, Nueva York. Esta presa utiliza una compuerta controlada remotamente desde 2013 para controlar el flujo de agua según los niveles y temperaturas del arroyo Blind Brook. Los atacantes lograron recopilar información sobre niveles de agua, temperatura y estado de la compuerta, aunque esta estaba desconectada manualmente para mantenimiento durante la intrusión. El ataque se realizó mediante "Google dorking", una técnica que utiliza el motor de búsqueda Google para localizar vulnerabilidades en aplicaciones web.

\subsection{Tácticas y técnicas según MITRE ATT\&CK}
Las tácticas y técnicas utilizadas incluyen:

\begin{itemize}
    \item \textbf{Reconocimiento} - \textit{Escaneo de redes activo} (T0842) y \textit{Reconocimiento de recursos web accesibles públicamente} (T0856), utilizando Google dorking para identificar vulnerabilidades.
    
    \item \textbf{Acceso Inicial} - \textit{Explotación de aplicaciones accesibles públicamente} (T0819), accediendo a la aplicación web de control sin protección adecuada.
    
    \item \textbf{Recolección} - \textit{Puntos de datos I/O} (T0802), recopilando datos sobre niveles de agua, temperatura y estado de la compuerta.
\end{itemize}

\subsection{Justificación de las tácticas y técnicas}
Los atacantes eligieron estas tácticas porque:

\begin{itemize}
    \item El sistema de control estaba directamente accesible desde Internet sin firewall ni controles de autenticación, haciendo del reconocimiento una táctica efectiva.
    
    \item Google dorking es una técnica de bajo esfuerzo que permite identificar sistemas vulnerables sin alertar a los objetivos.
    
    \item La aplicación web para monitoreo y control no implementaba medidas de seguridad básicas, facilitando el acceso no autorizado.
    
    \item La recopilación de datos sobre el sistema proporcionaba información valiosa para posibles ataques futuros más destructivos.
\end{itemize}

\subsection{Respuesta al incidente}
Después del ataque, se instalaron un nuevo software y una nueva compuerta. Por dirección del Gobernador Cuomo, el Estado de Nueva York tomó múltiples medidas para mejorar sus capacidades de ciberseguridad en varios sectores. Las investigaciones realizadas por el DHS y el Departamento de Justicia resultaron en la acusación de varios hackers patrocinados por un estado. El ataque causó más de $30,000 en costos de remediación.

\subsection{Evaluación de la respuesta}
La respuesta fue adecuada pero principalmente reactiva:

\begin{itemize}
    \item Positivo: La instalación de nuevo software y hardware con mejores características de seguridad.
    \item Positivo: El impulso a nivel estatal para mejorar las capacidades de ciberseguridad en infraestructuras críticas.
\end{itemize}

Propondría las siguientes mejoras:

\begin{itemize}
    \item Implementación de evaluaciones de seguridad previas al despliegue de aplicaciones web críticas.
    \item Establecimiento de una arquitectura de acceso remoto seguro con múltiples capas de autenticación.
    \item Monitoreo continuo de búsquedas en Internet que puedan revelar información sensible sobre infraestructuras críticas.
    \item Implementación de programas de capacitación y concientización sobre ciberseguridad para el personal que gestiona infraestructuras críticas.
\end{itemize}

